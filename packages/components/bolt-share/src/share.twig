{% set shareSources = sources is null ? ['facebook','twitter','linkedin'] : sources %}
{% set emailShare = email is sameas(false) ? false : (email is null ? true : email) %}
{% set copyShare = copy is sameas(false) ? false : (copy is null ? true : copy) %}
{% set visible = visibility is not empty ? visibility : 'visible' %}
{% set isFlat = inline is sameas(false) ? false : (inline is null ? false : inline) %}

{% set items = [] %}

{% if isFlat is sameas(true) %}
  {% set items = items|merge([include("@bolt-components-headline/text.twig", {
    text: "Share",
    transform: 'uppercase',
    weight: 'bold'
  })]) %}
{% endif %}

{% if 'facebook' in shareSources %}
  {% set items = items|merge([include("@bolt-components-link/link.twig", {
    text: "Facebook",
    url: "#fb",
    icon: {
      name: "facebook-solid",
      position: "before",
      size: 'medium'
    },
    attributes: create_attribute(imageAttributes | default({})).addClass('js-bolt-share__facebook')
  })]) %}
{% endif %}

{% if 'twitter' in shareSources %}
  {% set items = items|merge([include("@bolt-components-link/link.twig", {
    text: "Twitter",
    url: "#tw",
    icon: {
      name: "twitter",
      position: "before",
      size: 'medium'
    },
    attributes: create_attribute(imageAttributes | default({})).addClass('js-bolt-share__twitter')
  })]) %}
{% endif %}

{% if 'linkedin' in shareSources %}
  {% set items = items|merge([include("@bolt-components-link/link.twig", {
    text: "LinkedIn",
    url: "#li",
    icon: {
      name: "linkedin",
      position: "before",
      size: 'medium'
    },
    attributes: create_attribute(imageAttributes | default({})).addClass('js-bolt-share__linkedin')
  })]) %}
{% endif %}

{% if emailShare %}
  {% set items = items|merge([include("@bolt-components-link/link.twig", {
    text: "Email",
    url: "#email",
    icon: {
      name: "email",
      position: "before",
      size: 'medium'
    }
  })]) %}
{% endif %}

{% if copyShare %}
  {% set items = items|merge([include("@bolt-components-copy-to-clipboard/copy-to-clipboard.twig", {
    url: "http://bolt-design-system.com"
  })]) %}
{% endif %}

{% set attributes = create_attribute(attributes|default({})) %}
{% set classes = [
  'c-bolt-share',
  'c-bolt-share--' ~ visible,
  isFlat is sameas(false) ? 'c-bolt-share--normal-layout'
] %}

<bolt-share>
  <div {{ attributes.addClass(classes) }}>
    {% include "@bolt-components-tooltip/tooltip.twig" with {
      trigger: {
        type: "button",
        text: "Share",
        transform: "uppercase",
        icon: {
          name: "share1",
          size: "medium"
        },
        toggle: {
          text: "Close",
          name: "close-solid"
        }
      },
      content: include ("@bolt-components-block-list/block-list.twig", {
      "contentItems" : items
      }),
      position: "up",
      noWrap: true,
      spacing: "none"
    } only %}
  </div>
</bolt-share>

{% if enable_json_schema_validation %}
  {{ validate_data_schema('@bolt-components-share/share.schema.yml', _self) }}
{% endif %}