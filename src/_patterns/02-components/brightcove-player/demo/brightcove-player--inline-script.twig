<script type="text/javascript">
  <!-- https://fokkezb.nl/2016/04/14/how-to-wait-for-a-javascript-variable-to-be-defined/ -->
  <!-- https://github.com/OwenMelbz/whendefined -->
  (function(){window.whenDefined=function(a,b,c){a[b]?c():Object.defineProperty(a,b,{configurable:!0,enumerable:!0,writeable:!0,get:function(){return this["_"+b]},set:function(a){this["_"+b]=a,c()}})}}).call(this);


  function pegaCustomInitVideo(elem){

    whenDefined(window, 'bc', function() {
      var id = elem.state.id;

      videojs(id).ready(function(){
        var pegaPlayer = this;

        var options = {
          "playbackRates": [1, 1.3, 1.5, 2]
        }

        pegaPlayer.social({
          "url": "https://local.d8.pega.com/insights/resources/intelligent-virtual-assistant-email",
          "displayAfterVideo": true,
          "services": {
            "facebook": true,
            "google": false,
            "twitter": true,
            "linkedin": true,
            "pinterest": false,
            "tumblr": false
          }
        });

        pegaPlayer.emailSocialShare();


        if (pegaPlayer.controlBar.playbackRateMenuButton) {
          // Update the existing playback rate menu button in the control bar
          var playbackControl = pegaPlayer.controlBar.playbackRateMenuButton;
          playbackControl.removeChild(playbackControl.menu);
          playbackControl.options_.playbackRates = options.playbackRates;
          playbackControl.addChild(playbackControl.createMenu());
          playbackControl.updateLabel();
          playbackControl.updateVisibility();
        } else {
          // Add the playback rate menu button to the control bar
          pegaPlayer.controlBar.playbackRateMenuButton = pegaPlayer.controlBar.addChild('PlaybackRateMenuButton', {
            playbackRates: options.playbackRates
          });
          pegaPlayer.controlBar.playbackRateMenuButton.updateVisibility();
        }
      });
    });
  }

</script>

{% include "@bolt/video.twig" with {
  "videoId": "5609376179001",
  "accountId": "1900410236",
  "playerId": "r1CAdLzTW",
  "attributes": {
    "on-init": "pegaCustomInitVideo",
    "data-email-subject": "Pega - Intelligent Virtual Assistant for Email",
    "data-email-body": "Check out this video from Pega",
    "data-email-videourl": "https://local.d8.pega.com/insights/resources/intelligent-virtual-assistant-email"
  }
} only %}