{#
  TODO:
  - more space when justified flex-start

  Need more info:
  - premium tag position math, make it configurable.
    - fixed width.
    - up to 12 characters?
    - only on hover?
#}

{# Schema Validation #}
{% set schema = bolt.data.components['@bolt-components-teaser'].schema %}
{% if enable_json_schema_validation %}
  {{ validate_data_schema(schema, _self)|raw }}
{% endif %}

{# Variables #}
{% set this = init(schema) %}
{% set attributes = create_attribute(attributes|default({})) %}
{% set _teaser_id = bolt.data.config.env == 'test' ? 'js-test-target' : 'js-bolt-teaser-' ~ random() %}

{# Array of classes based on the defined + default props #}
{% set classes = [
  'c-bolt-teaser',
  this.data.layout.value ? 'c-bolt-teaser--' ~ this.data.layout.value,
  this.data.gutter.value ? 'c-bolt-teaser--gutter-' ~ this.data.gutter.value,
  _teaser_id
] %}

<article {{ attributes.addClass(classes) }}>
  {% if signifier %}
    <div class="c-bolt-teaser__signifier">
      <div class="c-bolt-teaser__signifier-image">
        {{ signifier }}
      </div>

      {% if this.data.type.value == 'video' %}
        <div class="c-bolt-teaser__signifier-type c-bolt-teaser__signifier-type--video" aria-hidden="true"></div>
      {% endif %}

      {% if this.data.meta.value %}
        <div class="c-bolt-teaser__signifier-meta">
          {{ meta }}
        </div>
      {% endif %}

      {% if this.data.description.value and not this.data.show_description.value %}
        <div class="c-bolt-teaser__signifier-description" aria-hidden="true">
          <div class="c-bolt-teaser__signifier-description-text">
            {{ this.data.description.value }}
          </div>
        </div>
      {% endif %}

      {% if this.data.premium.value %}
        <div class="c-bolt-teaser__signifier-premium">
          {{ 'Premium'|t }}
        </div>
      {% endif %}
    </div>
  {% endif %}

  <div class="c-bolt-teaser__content">
    {% if headline %}
      <div class="c-bolt-teaser__headline">
        {% if headline.link_attributes %}
          {% set _linked_text %}
            {% include '@bolt-elements-text-link/text-link.twig' with {
              content: headline.text,
              reversed_underline: true,
              expand_click_target: true,
              attributes: headline.link_attributes
            } only %}
          {% endset %}
        {% endif %}
        {% include '@bolt-components-headline/headline.twig' with {
          text: headline.link_attributes ? _linked_text : headline.text,
          tag: headline.tag,
          size: headline.size,
        } only %}
      </div>
    {% endif %}

    {% if subheadline %}
      <div class="c-bolt-teaser__subheadline">
        {% include '@bolt-components-headline/subheadline.twig' with {
          text: subheadline.text,
          tag: subheadline.tag,
          size: subheadline.size,
        } only %}
      </div>
    {% endif %}

    {% if this.data.eyebrow_text.value or this.data.featured.value %}
      <div class="c-bolt-teaser__eyebrow">
        {% if this.data.featured.value %}
          {% set _eyebrow_text = 'Featured'|t %}
        {% elseif this.data.eyebrow_text.value %}
          {% set _eyebrow_text = this.data.eyebrow_text.value %}
        {% endif %}
        {% include '@bolt-components-headline/eyebrow.twig' with {
          text: _eyebrow_text,
        } only %}
      </div>
    {% endif %}

    {% if this.data.views or share_menu or like_button %}
      <div class="c-bolt-teaser__actions">
        {% if this.data.views %}
          <div class="c-bolt-teaser__views">
            {% include '@bolt-components-icon/icon.twig' with {
              name: 'eye',
            } only %}
            {{ this.data.views.value }} {{ 'views'|t }}
          </div>
        {% endif %}

        {% if like_button or share_menu %}
          <ul class="c-bolt-teaser__action-list">
            {% if like_button %}
              <li class="c-bolt-teaser__action-list-item">
                {{ like_button }}
              </li>
            {% endif %}
            {% if share_menu %}
              <li class="c-bolt-teaser__action-list-item">
                {% set _share_popover_trigger %}
                  {% include '@bolt-components-link/link.twig' with {
                    text: 'Share',
                    icon: {
                      name: 'share',
                      position: 'before',
                    },
                    type: 'button',
                    isHeadline: true,
                  } only %}
                {% endset %}
                {% include '@bolt-components-popover/popover.twig' with {
                  trigger: _share_popover_trigger,
                  content: share_menu,
                  spacing: 'none',
                  boundary: '.' ~ _teaser_id,
                } only %}
              </li>
            {% endif %}
          </ul>
        {% endif %}
      </div>
    {% endif %}

    {% if this.data.description.value %}
      <div class="c-bolt-teaser__description {{ this.data.show_description.value ? '' : 'u-bolt-visuallyhidden' }}">
        {{ this.data.description.value }}
      </div>
    {% endif %}

    {% if chip_list %}
      <div class="c-bolt-teaser__chips">
        {% include '@bolt-components-chip-list/chip-list.twig' with chip_list only %}
      </div>
    {% endif %}
  </div>
</article>
