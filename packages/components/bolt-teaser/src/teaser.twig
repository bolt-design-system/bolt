{#
  TODO:
  - more space when justified flex-start

  Need more info:
  - Are we planning to replicate the video meta timer inside the thumbnail?
  - premium tag position math, make it configurable.
    - fixed width.
    - up to 12 characters?
    - only on hover?
#}

{# Schema Validation #}
{% set schema = bolt.data.components["@bolt-components-teaser"].schema %}
{% if enable_json_schema_validation %}
  {{ validate_data_schema(schema, _self)|raw }}
{% endif %}

{# Variables #}
{% set this = init(schema) %}
{% set attributes = create_attribute(attributes|default({})) %}

{# Array of classes based on the defined + default props #}
{% set classes = [
  'c-bolt-teaser',
  this.data.layout.value ? 'c-bolt-teaser--' ~ this.data.layout.value : '',
] %}

<article {{ attributes.addClass(classes) }}>
  {% if image %}
    <div class="c-bolt-teaser__thumbnail">
      <div class="c-bolt-teaser__thumbnail-image">
        {{ image }}
      </div>

      {% if this.data.premium.value %}
        <div class="c-bolt-teaser__thumbnail-premium">
          Premium
        </div>
      {% endif %}

      {% if this.data.type.value %}
        <div class="c-bolt-teaser__thumbnail-type">
          {% if this.data.type.value == 'video' %}
            {% set _icon_name = "asset-video" %}
          {% elseif this.data.type.value == 'pdf' %}
            {% set _icon_name = "asset-media" %}
          {% elseif this.data.type.value == 'article' %}
            {% set _icon_name = "asset-text" %}
          {% endif %}

          {% include "@bolt-components-icon/icon.twig" with {
            name: _icon_name,
            background: "square",
            size: "small",
            color: "yellow",
          } only %}
        </div>
      {% endif %}

      {% if this.data.description.value and not this.data.show_description.value %}
        <div class="c-bolt-teaser__thumbnail-description-wrapper" aria-hidden="true">
          <div class="c-bolt-teaser__thumbnail-description">
            {{ this.data.description.value }}
          </div>
        </div>
      {% endif %}
    </div>
  {% endif %}

  <div class="c-bolt-teaser__content">
    {% if this.data.eyebrow_text.value %}
      <div class="c-bolt-teaser__eyebrow">
        {% include "@bolt-components-headline/eyebrow.twig" with {
          text: this.data.eyebrow_text.value,
        } only %}
      </div>
    {% endif %}

    {% if headline %}
      {% set _icon_chevron_right %}
        {% include '@bolt-components-icon/icon.twig' with {
          name: 'chevron-right',
        } only %}
      {% endset %}

      <div class="c-bolt-teaser__headline">
        {% set _action %}
          {% include '@bolt-elements-text-link/text-link.twig' with {
            content: headline.text,
            expand_click_target: true,
            icon_after: _icon_chevron_right,
            reversed_underline: true,
            attributes: headline.link_attributes
          } only %}
        {% endset %}

        {% if headline.size %}
          {% set _headline_size = headline.size %}
        {% else %}
          {% set _headline_size = 'large' %}
        {% endif %}

        {% include '@bolt-components-headline/headline.twig' with {
          text: _action,
          tag: 'h2',
          size: _headline_size,
        } only %}
      </div>
    {% endif %}

    {% if meta_items or share_menu or like_button %}
      <div class="c-bolt-teaser__meta-action-content">
        {% if meta_items %}
          {% for item in meta_items %}
              <div class="c-bolt-teaser__meta-item">
                  {{ item }}
              </div>
          {% endfor %}
        {% endif %}

        {% if share_menu %}
          {% set share_button %}
            {% set _share_popover_trigger %}
                {% include '@bolt-components-link/link.twig' with {
                  text: 'Share',
                  icon: {
                    name: 'share',
                    position: 'before',
                  },
                  type: 'button',
                  isHeadline: true,
                } only %}
            {% endset %}
            {% include '@bolt-components-popover/popover.twig' with {
              trigger: _share_popover_trigger,
              content: share_menu,
              spacing: 'none',
            } only %}
          {% endset %}
        {% endif %}

        {% if like_button or share_button %}
          <div class="c-bolt-teaser__meta-action-items">
            {% if like_button %}
              <div class="c-bolt-teaser__meta-action-item">
                {{ like_button }}
              </div>
            {% endif %}
            {% if share_button %}
              <div class="c-bolt-teaser__meta-action-item">
                {{ share_button }}
              </div>
            {% endif %}
          </div>
        {% endif %}
      </div>
    {% endif %}

    {% if this.data.description.value %}
      <div class="c-bolt-teaser__description {{ this.data.show_description.value ? '' : 'u-bolt-visuallyhidden' }}">
        {{ this.data.description.value }}
      </div>
    {% endif %}

    {% if chip_list %}
      <div class="c-bolt-teaser__chips">
        {% include '@bolt-components-chip-list/chip-list.twig' with chip_list only %}
      </div>
    {% endif %}
  </div>
</article>
