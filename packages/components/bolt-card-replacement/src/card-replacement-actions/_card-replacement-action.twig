{% set action_schema = bolt.data.components["@bolt-components-card-replacement"].schema.properties.actions %}
{% set action_this = init(action_schema) %}

<script>
  console.log({{ this.data|json_encode() }})
  console.log({{ action_this.data|json_encode() }})
  console.log("--")
</script>

<bolt-card-replacement-action {% if external %} external {% endif %} {% if url %} url="{{url}}" {% endif %}>
  <ssr-keep for="bolt-card-replacement-action" class="c-bolt-card_replacement__action">
    {% block action_item %}
      {% if this.data.text.value %}
        {% set button_props = {
          text: this.data.text.value,
          hierarchy: "text",
          width: "full",
          align: "start",
          target: this.data.external.value == true ? "_blank" : "_self",
          attributes: attributes|default({})
        } %}

        {# this.data.spacing.value is sometimes equal to null so conditional is required. #}
        {% if this.data.spacing.value is not empty %}
          {% set button_props = button_props|merge({ size: this.data.spacing.value }) %}
        {% endif %}

        {% if icon != 'none' %}
          {% if icon %}
            {% set button_props = button_props|merge({ icon: { name: icon } }) %}
          {% elseif external == false or external == null %}
            {% set button_props = button_props|merge({ icon: { name: "chevron-right" } }) %}
          {% else %}
            {% set button_props = button_props|merge({ icon: { name: "external-link" } }) %}
          {% endif %}
        {% endif %}

        {% if this.data.url.value is not empty %}
          {% set button_props = button_props|merge({ url: this.data.url.value }) %}
        {% endif %}

        {% include "@bolt-components-button/button.twig" with button_props only %}
      {% endif %}
    {% endblock %}
  </ssr-keep>
</bolt-card-replacement-action>
